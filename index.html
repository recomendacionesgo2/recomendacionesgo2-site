<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Recomendaciones Go2 — Productos probados y de confianza</title>
<meta name="description" content="Guía práctica con productos probados por Go2: herramientas, hogar, impresión 3D y más. Recomendaciones honestas basadas en uso real."/>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link href="https://fonts.gstatic.com" rel="preconnect" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet"/>

<style>
  :root{ --ink:#111827; --muted:#6b7280; --bg:#ffffff; --panel:#f7f7f7; --beige:#cbb682; --ring:#e5e7eb; --beige-soft:#F9F6F0;}
  [id]{ scroll-margin-top: 70px; }
  @media (max-width: 1024px) { [id] { scroll-margin-top: 55px; } }
  @media (max-width: 640px)  { [id] { scroll-margin-top: 40px; } }
  *{box-sizing:border-box} html{scroll-behavior:smooth}
  body{margin:0;color:var(--ink);background:var(--bg);font-family:"Inter",system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;line-height:1.6;}
  header{border-bottom:1px solid var(--ring);background:#fff;position:sticky;top:0;z-index:20}
  .container{max-width:1120px;margin:0 auto;padding:18px 20px}
  .row{display:flex;align-items:center;gap:18px}
  .brand{font-family:Montserrat,system-ui,sans-serif;font-weight:700;font-size:22px}
  nav{margin-left:auto;display:flex;gap:26px;font-weight:600;letter-spacing:.2px}
  nav a{
    position: relative;
    color:var(--ink);
    text-decoration: none;
  }
  nav a::after{
    content:"";
    position:absolute;
    left:0; bottom:-6px;
    width:100%; height:2px;
    background: var(--beige);
    transform: scaleX(0);
    transform-origin:left;
    transition: transform .3s ease;
  }
  nav a:hover::after,
  nav a.active::after{ transform: scaleX(1); }

  .btn-outline{background:#fff;border:1px solid var(--ink);padding:10px 14px;border-radius:6px;font-weight:700;text-decoration:none;color:var(--ink)}
  .btn-primary{background:var(--beige);color:#fff;padding:10px 16px;border-radius:6px;font-weight:700;text-decoration:none}
  .hero-top{padding:36px 20px 48px;text-align:center}
  .label{font-size:12px;letter-spacing:.15em;color:#555;}
  h1,h2,h3{font-family:Montserrat,system-ui,sans-serif;margin:0}
  .hero-top h1{font-size:40px;margin:10px 0 16px}
  .band{background:#fafafa;border-top:1px solid var(--ring);border-bottom:1px solid var(--ring);padding-top:8px !important;padding-bottom:8px !important}
  .featured, .section-5{padding-top:92px;padding-bottom:60px}
  .trust{max-width:1120px;margin:0 auto;padding:48px 20px;display:grid;grid-template-columns:1fr 1fr;gap:40px;align-items:center;position:relative}
  .trust img{width:100%;border-radius:4px;box-shadow:0 2px 12px rgba(0,0,0,.06)}
  .trust .media-wrap{display:flex;flex-direction:column;align-items:center}
  .eyebrow{font-size:14px;letter-spacing:.15em;color:var(--beige);font-weight:700;margin-bottom:12px}
  .trust h2{font-size:54px;font-weight:700;line-height:1.1;margin:0 0 14px}
  .trust p{font-size:20px;color:#4b5563;margin:0 0 22px}
  .kicker{font-size:13px;letter-spacing:.18em;color:var(--beige);font-weight:800}
  .section{max-width:1120px;margin:0 auto;padding:36px 20px}
  .section h3{font-size:32px;margin:4px 0 16px}
  .cards{display:grid;gap:22px;grid-template-columns:repeat(3,minmax(0,1fr))}
  @media (max-width:960px){.cards{grid-template-columns:repeat(2,minmax(0,1fr))}.trust{grid-template-columns:1fr}.trust h2{font-size:36px;line-height:1.08}}
  @media (max-width:640px){.cards{grid-template-columns:1fr}}
  .card{background:#fff;border:1px solid var(--ring);border-radius:8px;overflow:hidden}
  .thumb{width:100%;height:auto;aspect-ratio:1/1;object-fit:cover;display:block}
  .pad{padding:16px}
  .card h4{font-size:18px;margin:4px 0}
  .sub{color:var(--muted);font-size:14px}
  .buy{display:inline-block;margin-top:10px;background:var(--ink);color:#fff;padding:10px 14px;border-radius:6px;text-decoration:none;font-weight:700}
  .why{display:inline-block;margin-top:10px;border:1px solid var(--ring);padding:8px 12px;border-radius:6px;text-decoration:none;font-weight:600;color:var(--ink)}
  .why + .reason{display:none;margin-top:10px;background:#fbfbfb;border:1px dashed var(--ring);padding:10px;border-radius:6px;font-size:14px}
  .criteria{background:#f6f6f6;border-top:1px solid var(--ring);border-bottom:1px solid var(--ring)}
  .criteria .inner{max-width:960px;margin:0 auto;padding:40px 20px;text-align:center}
  .criteria h3{font-size:28px;margin:0 0 10px}
  .criteria p{margin:8px 0;color:#485260}
  .criteria ul{list-style:none;padding:0;margin:12px auto;max-width:720px;color:#485260}
  .criteria li{margin:6px 0}
  .social-purpose{background:var(--beige-soft);border-top:1px solid var(--ring)}
  .social-purpose .inner{max-width:960px;margin:0 auto;padding:36px 20px}
  .social-purpose h3{font-size:22px;margin:0 0 8px}
  footer{border-top:1px solid var(--ring);background:#fbfbfb}
  .foot{max-width:1120px;margin:0 auto;padding:28px 20px 48px;color:#6b7280}

  /* Fondo completo para #quien */
  #quien{position:relative;background:var(--beige-soft)}
  #quien::before{content:"";position:absolute;inset:0;z-index:-1;box-shadow:0 0 0 100vmax var(--beige-soft);clip-path: inset(0 -100vmax);}

  /* Controles del destacado */
  .carousel-controls{ display:flex; justify-content:center; gap:.6rem; margin-top:.6rem; }
  .carousel-controls button{
    background:#fff; border:1px solid #d1d5db; color:#374151;
    width:34px; height:34px; border-radius:6px; cursor:pointer; font-weight:600;
  }

  /* Ajustes “5 estrellas” aprobados */
  #destacado .trust{ display:grid; grid-template-columns:1fr 1fr; align-items:start; padding-top:0!important; margin-top:-55px!important; padding-bottom:60px!important; }
  #destacado .trust img{ justify-self:start; }
  #destacado .trust .eyebrow, #destacado .trust h2, #destacado .trust p{ text-align:left; margin-left:0; margin-right:0; }
  #destacado .trust a.btn-primary{ display:inline-block; margin-left:0; margin-right:0; }
  #destacado .trust > div:nth-of-type(2){ transform:translateY(22px); will-change:transform; }

  /* Marco vertical 4:5 para imagen destacada */
  #destacado .trust .hero-frame{ width:100%; aspect-ratio:4/5; overflow:hidden; border-radius:8px; background:#fff; margin-top:22px; margin-bottom:clamp(12px,1.5vw,18px); }

  /* Barra sticky bajo el título de productos */
  .products-toolbar{ position:sticky; top:82px; z-index:15; background:var(--bg); border-bottom:1px solid var(--ring); margin:8px 0 18px; padding:10px 0; }
  .products-toolbar .search-wrap{ max-width:460px; }
  #productSearch{ width:100%; padding:12px 14px; border:1px solid var(--ring); border-radius:8px; font:inherit; }
  .suggestions{ display:none; position:absolute; margin-top:6px; max-width:460px; background:#fff; border:1px solid var(--ring); border-radius:8px; box-shadow:0 4px 18px rgba(0,0,0,.08); list-style:none; padding:6px 0; }
  .suggestions li{ padding:10px 12px; cursor:pointer; display:flex; gap:8px; align-items:center; }
  .suggestions li:hover{ background:#f9fafb; }
  .suggestions .title{ font-weight:600; }
  .suggestions .sub{ color:var(--muted); font-size:13px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:320px; }
  .is-hidden{ display:none !important; }

  /* ⭐ Estrellas */
  .stars{ position:relative; width:110px; height:20px; }
  .stars::before{ content:"★★★★★"; letter-spacing:2px; font-size:18px; line-height:20px; color:#d1d5db; }
  .stars::after{ content:"★★★★★"; letter-spacing:2px; font-size:18px; line-height:20px; color:#cbb682; position:absolute; inset:0; width:var(--fill,0%); overflow:hidden; white-space:nowrap; }
  .stars small{ margin-left:8px; color:#6b7280; font-size:12px; vertical-align:2px; }

  /* Texto del acordeón (bajo el botón) */
  .card .reason{
    display:none;
    margin-top:10px;
    border:1px solid var(--ring);
    border-radius:8px;
    padding:10px 12px;
    background:#fff;
    white-space:normal;
    word-break:break-word;
    max-height:none !important;
    -webkit-line-clamp:unset !important;
    overflow:visible !important;
  }
</style>

<!-- Contact section style patch (scoped) -->
<style>
#contacto .contact{
  max-width: 680px; margin:16px auto 0; padding:20px 20px; background:#fff;
  border:1px solid var(--ring); border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,.03);
}
#contacto .contact .field{ display:flex; flex-direction:column; gap:6px; margin:10px 0; }
#contacto .contact label{ font-weight:600; color:var(--ink); }
#contacto .contact input,#contacto .contact textarea{
  width:100%; max-width:100%; box-sizing:border-box; padding:12px 14px; border:1px solid var(--ring); border-radius:8px; font:inherit; background:#fff;
}
#contacto .contact textarea{ min-height:140px; resize:vertical; }
#contacto .contact .submit{ margin-top:12px; background:var(--beige); color:#fff; padding:12px 16px; border:none; border-radius:8px; font-weight:700; cursor:pointer; }
#contacto .note{ color:#4b5563; }
@media (max-width:720px){ #contacto .contact{ padding:16px; border-radius:8px; } }
</style>
</head>

<body>
<header>
  <div class="container row">
    <div class="brand">Recomendaciones Go2</div>
    <nav>
      <a class="active" href="#inicio">INICIO</a>
      <a href="#productos" aria-label="Ir a productos">PRODUCTOS</a>
      <a href="#acerca">PROPÓSITO</a>
      <a href="#quien">QUIÉN RECOMIENDA</a>
    </nav>
  </div>
</header>

<main id="inicio">
  <section class="hero-top">
    <div class="label">RECOMENDACIONES DE CALIDAD</div>
    <h1>Productos probados y recomendados</h1>
    <a class="btn-primary" href="#productos">VER PRODUCTOS</a>
  </section>

  <div class="band featured" id="destacado">
    <section class="trust">
      <div class="media-wrap">
        <div class="hero-frame">
          <img id="hero-featured-img" alt="Producto destacado" src="/images/uploads/hero-5estrellas.png"/>
        </div>
        <div class="carousel-controls" id="featControls">
          <button type="button" id="prevFeat" aria-label="Anterior">‹</button>
          <button type="button" id="nextFeat" aria-label="Siguiente">›</button>
        </div>
      </div>
      <div>
        <div class="eyebrow">SECCIÓN 5 ESTRELLAS</div>
        <h2>Productos seleccionados con cuidado</h2>
        <p>En Recomendaciones Go2, comparto mis experiencias con productos de calidad que he probado personalmente. Mi objetivo es facilitarte la elección de herramientas, artículos para el hogar y tecnología que realmente valen la pena. Cada recomendación incluye una valoración y un enlace directo para que puedas adquirirlos fácilmente.</p>
        <p style="font-size:16px;color:#6b7280;margin-top:-8px">En la imagen de la izquierda irán alternando los productos que han conseguido <strong>5 estrellas</strong>.</p>
        <a class="btn-primary" href="#worx-destacado">Ver producto destacado</a>
      </div>
    </section>
  </div>

  <section class="criteria" aria-label="Criterios de recomendación">
    <div class="inner">
      <h3>Criterios de recomendación</h3>
      <p>Cada producto ha sido probado durante un uso mínimo de <strong>30 días</strong>.</p>
      <ul>
        <li>• Prestaciones y calidad percibida en el uso real.</li>
        <li>• Respuesta del proveedor o de Amazon ante dudas o incidencias.</li>
        <li>• Duración de la batería (si aplica), robustez, peso y precio.</li>
      </ul>
      <p><strong>Solo publico los productos que realmente considero buenos</strong> —no hago listas de “malos”— y las valoraciones van de <strong>4 a 5 estrellas</strong> según la experiencia real de uso.</p>
    </div>
  </section>

  <section id="productos" class="section">
    <div class="kicker">RECOMENDACIONES DE CALIDAD</div>
    <h3>Descubre productos que valen la pena</h3>

    <div class="products-toolbar" aria-label="Barra de búsqueda">
      <div class="search-wrap">
        <input id="productSearch" type="search" placeholder="Buscar productos (mín. 3 letras)…" autocomplete="off" aria-label="Buscar productos" />
        <ul id="searchSuggestions" class="suggestions" role="listbox" aria-label="Sugerencias"></ul>
      </div>
    </div>

    <p id="emptyProductsMsg" style="text-align:center;color:#6b7280;margin:24px 0 8px;font-size:14px">
      Aún no hay productos. Añade el primero desde <a href="/admin" style="color:#6b7280;text-decoration:underline">/admin</a>.
    </p>

    <div class="cards" id="productCards"></div>
  </section>

  <section id="acerca" class="social-purpose" aria-label="Transparencia y propósito social">
    <div class="inner">
      <h3>Transparencia y propósito social</h3>
      <p>La cuenta de afiliado de Amazon pertenece a la <strong>Asociación Go2</strong>, y los ingresos generados se destinan íntegramente a financiar proyectos sociales, materiales educativos y acciones de sostenibilidad.</p>
      <p><strong>¿Por qué apoyarnos a través de Amazon?</strong><br/>Cada vez que adquieres un producto desde nuestros enlaces, una parte se destina a los programas solidarios de la Asociación Go2, <em>sin coste adicional para ti</em>.</p>
    </div>
  </section>

  <section id="quien" class="section" aria-label="Quién recomienda" style="background:#F9F6F0;">
    <div class="container" style="max-width:920px;margin:0 auto;">
      <h3 style="font-size:32px;margin:8px 0 12px">Quién recomienda</h3>
      <div class="prose" style="font-size:18px;line-height:1.6;color:#374151">
        <p><strong>Sobre Sebastián Ferragut</strong></p>
        <p>Soy el responsable de probar, comparar y seleccionar cada producto que aparece en <strong>Recomendaciones Go2</strong>. Desde mi trabajo en primera línea en los distintos departamentos de la <strong>Asociación Go2</strong> —reformas, impresión 3D, sostenibilidad y proyectos técnicos— utilizo personalmente cada herramienta, material o dispositivo antes de recomendarlo.</p>
        <p>Mi objetivo es <strong>recomendar solo productos</strong> que hayan demostrado buen rendimiento, durabilidad y servicio posventa, tanto en el ámbito profesional como doméstico. Aquí encontrarás desde materiales de construcción y herramientas, hasta filamentos 3D, electrodomésticos o soluciones que usamos en las propias obras y proyectos de Go2.</p>
        <p><strong>Solo publico aquello que realmente funciona y que he probado personalmente.</strong></p>
      </div>
    </div>
  </section>

  <section id="contacto" class="section" aria-label="Contacto">
    <h3>Contacto</h3>
    <div class="contact">
      <p class="note">¿Tienes dudas o sugerencias? Envíanos tu mensaje a través de este formulario. Las respuestas pueden tardar hasta <strong>72 horas</strong>.</p>
      <form name="contact" method="POST" data-netlify="true" action="/?success=1">
        <input type="hidden" name="form-name" value="contact"/>
        <div class="field"><label for="name">Nombre</label><input id="name" name="name" required/></div>
        <div class="field"><label for="email">Correo electrónico</label><input id="email" type="email" name="email" required/></div>
        <div class="field"><label for="message">Mensaje</label><textarea id="message" rows="5" name="message" required></textarea></div>
        <button class="submit" type="submit">Enviar mensaje</button>
      </form>
      <p id="ok" style="display:none;margin-top:10px;color:#065f46;font-weight:600">Gracias por tu mensaje. Te responderemos en un plazo máximo de 72 horas.</p>
    </div>
  </section>

  <footer><div class="foot"><p>© <span id="year"></span> Recomendaciones Go2 — por Sebastián Ferragut</p></div></footer>
</main>

<script>
if (new URLSearchParams(location.search).get('success') === '1'){
  const ok = document.getElementById('ok'); if(ok) ok.style.display = 'block';
}
document.getElementById('year').textContent = new Date().getFullYear();
</script>

<!-- Fit de imagen del destacado -->
<script>
(function(){
  var img = document.getElementById('hero-featured-img');
  if(!img) return;
  function applyFitMode() {
    var w = img.naturalWidth, h = img.naturalHeight;
    if(!w || !h) { setTimeout(applyFitMode, 50); return; }
    var isWide = (w / h) > 1.05;
    var frame = img.parentElement;
    if(!frame) return;
    frame.classList.toggle('contain', isWide);
  }
  img.addEventListener('load', applyFitMode);
  applyFitMode();
  window.__applyHeroFitMode = applyFitMode;
})();
</script>

<!-- Resaltado de navegación -->
<script>
(function(){
  const navLinks = document.querySelectorAll('header nav a[href^="#"]');
  const map = {};
  navLinks.forEach(a => {
    const id = a.getAttribute('href');
    const sec = document.querySelector(id);
    if (sec) map[id] = { link:a, sec };
  });
  const obs = new IntersectionObserver((entries)=>{
    entries.forEach(entry=>{
      const id = '#'+entry.target.id;
      if (!map[id]) return;
      if (entry.isIntersecting) {
        navLinks.forEach(l => l.classList.remove('active'));
        map[id].link.classList.add('active');
      }
    });
  }, { root:null, rootMargin:"-50% 0px -45% 0px", threshold:0 });
  Object.values(map).forEach(({sec}) => obs.observe(sec));
  navLinks.forEach(a=>{
    a.addEventListener('click', ()=>{
      navLinks.forEach(l => l.classList.remove('active'));
      a.classList.add('active');
    });
  });
})();
</script>

<!-- Render de productos + acordeón simple -->
<script>
(async function(){
  const grid = document.querySelector('.cards');
  const emptyNote = document.getElementById('emptyProductsMsg');
  try {
    const res = await fetch('/assets/products.json', { cache: 'no-store' });
    const items = res.ok ? await res.json() : [];
    if (!items.length) {
      if (emptyNote) emptyNote.style.display = 'block';
      return;
    }
    if (emptyNote) emptyNote.style.display = 'none';

    items.forEach(p => {
      const art = document.createElement('article');
      art.className = 'card';
      art.id = `prod-${p.slug}`;
      art.innerHTML = `
        <img class="thumb" src="${p.image || ''}" alt="${p.title || ''}">
        <div class="pad">
          <h4>${p.title || ''}</h4>
          <div class="sub">${p.summary || ''}</div>
          <a class="buy" href="${p.buy_url || '#'}" target="_blank" rel="nofollow noopener">Comprar en Amazon</a>
          <a class="why" data-open="why-${p.slug}" href="#why-${p.slug}">Ver por qué lo recomiendo</a>
          <div class="reason" id="why-${p.slug}">${p.why || ''}</div>
        </div>
      `;

      // Estrellas
      const fill = Math.max(0, Math.min(100, (p.rating/5)*100));
      const stars = document.createElement('div');
      stars.className = 'stars';
      stars.style.setProperty('--fill', fill + '%');
      const label = document.createElement('small');
      label.textContent = p.rating.toFixed(1);
      stars.appendChild(label);

      const pad = art.querySelector('.pad');
      const sub = art.querySelector('.sub');
      if (pad && sub) pad.insertBefore(stars, sub);

      grid && grid.appendChild(art);

      // Acordeón bajo el botón (texto completo)
      const link  = art.querySelector('.why');
      const panel = art.querySelector('.reason');
      if (link && panel) {
        panel.style.display = 'none';
        link.setAttribute('aria-expanded','false');

        link.addEventListener('click', (e) => {
          e.preventDefault();

          // Cierra otros
          document.querySelectorAll('.card .reason').forEach(r=>{
            if (r !== panel) r.style.display = 'none';
          });

          const abrir = panel.style.display !== 'block';
          panel.style.display = abrir ? 'block' : 'none';
          link.setAttribute('aria-expanded', abrir ? 'true' : 'false');
          if (abrir) panel.scrollIntoView({ block:'nearest', behavior:'smooth' });
        });
      }
    });

    window.__products = items;
  } catch (e) {
    console.error('Error cargando productos:', e);
    if (emptyNote) emptyNote.style.display = 'block';
  }
})();
</script>

<!-- Carrusel destacado (sin tocar diseño) -->
<script>
(function(){
  function waitFor(cond, timeout=8000, interval=60){
    return new Promise((res, rej)=>{
      const t0 = Date.now();
      (function loop(){
        try{ if (cond()) return res(true); }catch(_){}
        if (Date.now() - t0 > timeout) return rej(new Error('timeout'));
        setTimeout(loop, interval);
      })();
    });
  }

  waitFor(()=> window.__products && document.querySelector('#destacado .hero-frame img') && document.querySelector('.cards'))
  .then(init)
  .catch(()=>{});

  function init(){
    const img = document.querySelector('#destacado .hero-frame img');
    if (!img) return;

    const btnDest = Array.from(document.querySelectorAll('a,button'))
      .find(el => el.textContent && el.textContent.trim() === 'Ver producto destacado');

    let prev = document.getElementById('prevFeat');
    let next = document.getElementById('nextFeat');

    if (!prev || !next){
      const ctrl = document.querySelector('.carousel-controls');
      if (ctrl){
        const btns = ctrl.querySelectorAll('button');
        if (btns.length >= 2){ prev = btns[0]; next = btns[1]; }
      }
    }

    const items = (window.__products || []).slice();

    const instructionSrc = img.getAttribute('src') || '/images/uploads/hero-5estrellas.png';

    const featuredSlides = items
      .filter(p => !!p.featured && p.image && p.slug)
      .map(p => ({ src: p.image, targetId: `prod-${p.slug}` }));

    if (!featuredSlides.length && items.length){
      const top = items.slice().sort((a,b)=>{
        if (b.rating !== a.rating) return b.rating - a.rating;
        return (b.date || '').localeCompare(a.date || '');
      })[0];
      if (top && top.image && top.slug){
        featuredSlides.push({ src: top.image, targetId: `prod-${top.slug}` });
      }
    }

    let slides = [];
    if (instructionSrc) slides.push({ src: instructionSrc, targetId: featuredSlides[0]?.targetId || null });
    slides = slides.concat(featuredSlides);
    if (!slides.length) return;

    slides.forEach(s => { const im = new Image(); im.src = s.src; });

    let i = 0;
    let currentTargetId = slides[i].targetId;

    function show(n){
      i = (n + slides.length) % slides.length;
      img.src = slides[i].src;
      currentTargetId = slides[i].targetId || null;
      if (btnDest && currentTargetId) btnDest.setAttribute('href', `#${currentTargetId}`);
    }

    show(0);

    if (prev) prev.onclick = e => { e.preventDefault(); show(i - 1); };
    if (next) next.onclick = e => { e.preventDefault(); show(i + 1); };

    if (btnDest){
      btnDest.addEventListener('click', (e)=>{
        e.preventDefault();
        if (!currentTargetId && featuredSlides.length){
          show(1 % slides.length);
          setTimeout(()=>{
            const node = document.getElementById(slides[i].targetId);
            if (node) node.scrollIntoView({ behavior:'smooth', block:'start' });
          }, 50);
          return;
        }
        if (currentTargetId){
          const node = document.getElementById(currentTargetId);
          if (node) node.scrollIntoView({ behavior:'smooth', block:'start' });
        }
      });
    }
  }
})();
</script>

<!-- Buscador -->
<script>
(function(){
  const grid = document.querySelector('.cards');
  const input = document.getElementById('productSearch');
  const list  = document.getElementById('searchSuggestions');
  if(!grid || !input || !list) return;

  let index = [];
  const buildIndex = () => {
    index = Array.from(grid.querySelectorAll('article.card')).map(card=>{
      const id  = card.id || '';
      const ttl = (card.querySelector('h4')?.textContent || '').trim();
      const sub = (card.querySelector('.sub')?.textContent || '').trim();
      return { id, ttl, sub, card, haystack: (ttl + ' ' + sub).toLowerCase() };
    });
  };
  buildIndex();

  const mo = new MutationObserver(buildIndex);
  mo.observe(grid, { childList: true });

  const showAll = () => index.forEach(x => x.card.classList.remove('is-hidden'));
  const clearSuggestions = () => { list.innerHTML = ''; list.style.display = 'none'; };
  const renderSuggestions = (hits) => {
    if (!hits.length) { clearSuggestions(); return; }
    list.innerHTML = hits.slice(0,6).map(h=>(
      `<li role="option" data-id="${h.id}">
         <span class="title">${h.ttl}</span>
         <span class="sub">${h.sub}</span>
       </li>`
    )).join('');
    list.style.display = 'block';
  };

  input.addEventListener('input', () => {
    const q = input.value.trim().toLowerCase();
    if (q.length < 3){
      showAll();
      clearSuggestions();
      return;
    }
    const hits = index.filter(x => x.haystack.includes(q));
    index.forEach(x => x.card.classList.toggle('is-hidden', !hits.includes(x)));
    renderSuggestions(hits);
  });

  input.addEventListener('keydown', (e)=>{
    if(e.key === 'Escape'){
      input.value = '';
      showAll();
      clearSuggestions();
    }
  });

  list.addEventListener('click', (e)=>{
    const li = e.target.closest('li[data-id]');
    if(!li) return;
    const id = li.getAttribute('data-id');
    const target = document.getElementById(id);
    if(target){
      target.scrollIntoView({ behavior:'smooth', block:'start' });
      clearSuggestions();
    }
  });

  input.addEventListener('blur', ()=> setTimeout(clearSuggestions, 150));
})();
</script>
</body>
  <style>
/* Baja todo el bloque de la sección 5 estrellas */
#destacado .trust {
  margin-top: 55px !important;
}
</style>
  <style>
/* Baja todo el bloque de la sección 5 estrellas */
#destacado .trust {
  margin-top: 100px !important;
}
</style>
</html>
